logging:
  level:
    no.einnsyn: INFO
    org:
      #hibernate: DEBUG
      #hibernate.SQL: DEBUG
      #hibernate.orm.jdbc.bind: TRACE
      #springframework: TRACE
      #elasticsearch: DEBUG

server:
  tomcat:
    relaxed-query-chars: "[,]"

application:
  innsynskravRetryInterval: 3600000
  elasticsearchIndex: ${ELASTICSEARCH_ACTIVE_INDEX:test}
  elasticsearchUri: ${ELASTICSEARCH_URIS:http://localhost:9200}
  userSecretExpirationTime: ${USER_SECRET_EXPIRY:86400} # 24 hours
  baseUrl: ${BASE_URL:http://localhost:8080}
  integrasjonspunkt:
    moveUrl: ${MOVE_URL:http://integrasjonspunkt:9093}
    orgnummer: ${IP_ORGNUMMER:000000000}
    expectedResponseTimeoutDays: ${EXPECTED_RESPONSE_TIMEOUT_DAYS:30}
  email:
    from: ${EMAIL_FROM:eInnsyn.no <test@example.com>}
  jwt:
    secret: ${JWT_SECRET:64b48c1a211bbe38b61fa1556f4afe1d86bf86b89d8365a11aab535d250bdadb}
    accessTokenExpiration: ${JWT_EXPIRATION:3600} # 1 hour
    refreshTokenExpiration: ${JWT_EXPIRATION:2419200} # 28 days

spring:
  config:
    import: optional:file:.env[.properties]
  main:
    allow-bean-definition-overriding: true
  mail:
    host: ${EMAIL_SMTP:localhost}
    port: ${EMAIL_PORT:25}
    username: ${EMAIL_USER:apikey}
    password: ${EMAIL_PASS:apisecret}
    properties:
      mail:
        smtp:
          auth: ${EMAIL_SMTP_AUTH:true}
          protocol: ${EMAIL_SMTP_PROTOCOL:smtps}
  jpa:
    open-in-view: true
    properties:
      hibernate:
        ddl-auto: validate
        session:
          events:
            log: LOG_QUERIES_SLOWER_THAN_MS=1000

  datasource:
    url: jdbc:postgresql://localhost/arkiv
    username: einnsyn
    password: admin
    hikari:
      maximum-pool-size: 8
  mvc:
    pathmatch:
      matching-strategy: ANT_PATH_MATCHER
    converters:
      preferred-json-mapper: gson
  flyway:
    enabled: true
    locations: classpath:db/migration
  # security:
  #   oauth2:
  #     client:
  #       registration:
  #         ansattporten:
  #           provider: ansattporten
  #           client-id: my-client-id
  #           client-secret: my-client-secret
  #           authorization-grant-type: authorization_code
  #           scope: openid,profile
  #       provider:
  #         ansattporten:
  #           issuer-uri: "https://ansattporten.no/.well-known/openid-configuration"
  threads:
    virtual.enabled: true

management:
  server:
    port: 8090
  endpoint:
    health:
      enabled: true
      show-details: always
    info:
      enabled: true
    metrics:
      enabled: true
    prometheus:
      enabled: true
  endpoints:
    web:
      base-path: /
      exposure:
        include: "*"
  prometheus:
    metrics:
      export:
        enabled: true

---
spring:
  config:
    activate:
      on-profile: test
  jpa:
    database-platform: org.hibernate.dialect.PostgreSQLDialect
    properties:
      hibernate:
        cache:
          use_second_level_cache: false
          use_query_cache: false
  datasource:
    driver-class-name: org.testcontainers.jdbc.ContainerDatabaseDriver
    url: jdbc:tc:postgresql:12.3:///arkiv
---
spring:
  config:
    activate:
      on-profile: container
logging:
  config: classpath:logback-container.xml
