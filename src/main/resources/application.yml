logging:
  level:
    no.einnsyn: ${LOG_LEVEL:INFO}
    #org.springframework.web:
    #hibernate: DEBUG
    #hibernate.SQL: DEBUG
    #hibernate.orm.jdbc.bind: TRACE
    #springframework: TRACE
    #elasticsearch: DEBUG

server:
  error:
    whitelabel:
      enabled: false
  tomcat:
    relaxed-query-chars: "[,]"
  compression:
    enabled: true
    mime-types: application/json, application/xml, text/html, text/xml, text/plain, application/javascript, text/css
    min-response-size: 1024

application:
  innsynskravRetryInterval: 3600000
  userSecretExpirationTime: ${USER_SECRET_EXPIRY:86400} # 24 hours
  baseUrl: ${BASE_URL:http://localhost:8080}
  elasticsearch:
    index: ${ELASTICSEARCH_ACTIVE_INDEX:test}
    uri: ${ELASTICSEARCH_URIS:http://localhost:9200}
    concurrency: ${ELASTICSEARCH_CONCURRENCY:5}
    reindexer:
      getBatchSize: ${ELASTICSEARCH_REINDEXER_GET_BATCH_SIZE:1000}
      indexBatchSize: ${ELASTICSEARCH_REINDEXER_INDEX_BATCH_SIZE:1000}
      saksmappeSchemaTimestamp: ${ELASTICSEARCH_REINDEXER_SAKSMAPPE_SCHEMA_TIMESTAMP:2024-09-19T18:03:00Z}
      journalpostSchemaTimestamp: ${ELASTICSEARCH_REINDEXER_JOURNALPOST_SCHEMA_TIMESTAMP:2024-09-19T18:03:00Z}
      moetemappeSchemaTimestamp: ${ELASTICSEARCH_REINDEXER_MOETEMAPPE_SCHEMA_TIMESTAMP:2024-09-19T18:03:00Z}
      moetesakSchemaTimestamp: ${ELASTICSEARCH_REINDEXER_MOETESAK_SCHEMA_TIMESTAMP:2024-09-19T18:03:00Z}
      cron:
        updateOutdated: ${ELASTICSEARCH_REINDEXER_CRON_UPDATE:0 0 * * * *} # Every hour
        removeStale: ${ELASTICSEARCH_REINDEXER_CRON_REMOVE:0 0 0 * * 6} # Every Saturday at midnight
  integrasjonspunkt:
    moveUrl: ${MOVE_URL:http://integrasjonspunkt:9093}
    orgnummer: ${IP_ORGNUMMER:000000000}
    expectedResponseTimeoutDays: ${EXPECTED_RESPONSE_TIMEOUT_DAYS:30}
  email:
    from: ${EMAIL_FROM:eInnsyn.no <test@example.com>}
    from_host: ${EMAIL_FROM_HOST:example.com}
  innsynskrav:
    debugRecipient: ${INNSYNSKRAV_DEBUG_RECIPIENT:}
  jwt:
    isRSA: ${JWT_IS_RSA:true}
    encryption-secret: ${JWT_SECRET:-----BEGIN RSA PRIVATE KEY-----\nMIIEpQIBAAKCAQEA5aySZhJxiAtbXI9XniVCc1if0U8KsZNyGfVJ+UKZE6o04yTn\nZFjA3DUYqPxFa7W7e2eSNbF0G7ZjmXKC5XIkEa1a+brC+eNLlwV/XouV4I/nOyxS\neY+zhorrI+ZR7AsI00D2VjOkiTUV5mdsAM8ulZBIeMk+XPAUfHQyQ5/4f46PT0GH\nKE7gICyBhg916+t+kt2sm9RW3cFk4r3rzqdBA7aAnF8NboO4hy9OJp08j3txgjbh\nJdaQcwzLWE14VRKxVXJb4EWbZMqBheeofdM6BEpu1ITkejCcnYZ2Q07cm+ststqb\nwd96LPV+gtMGAxY7X8F6Fou0q2SjspIeyF3fgQIDAQABAoIBAQDQlJ8H7+wHPzkj\noFJUH0Zv9qZ9sijmCB/xjyA1LNRUVZleR9+U9D2CPv48SY7KOOshMXhJJvVpTYS6\nkJJryfMT0rnyXjhANLorVyTLOj1NCaNXy/LCz0yc/YB6w+rWUVccc7zDoHbm3L0c\n2APv4DhQQA5xE2J9iNMyC1yyqY9GVvsFQu/ozHru6LGtgP5wMNGkaQ17XufB81KG\nWoPMRivvW8rR6jbnNgLNHtchNNIzxxW7ZIPNHFZUU9GVTgfhRnliNtlSti0mtyyP\nINSne1N0xGz5bA0dr7yZhOTG+JduEIOGfQ2LAIS7BSRyZPmMK+hm4O+8oo7mYjc4\n3ATIXG5ZAoGBAPrViB+b8RuH3bxYTEHdbcnHiPZ0RXDsNGOGhsITZ8QRYpBd2vRx\ni6H6mwQ9sUFLPmIa/xQYN+NOohmLKh1Vicu7BOcodpbSIGQfo7dVmjX6fEY+YFMm\nhjpsR83VK3+J+efOLoXI/lINQ09fOtfO0ldCP3Zufu0oQRgVU/331OCzAoGBAOpn\neohm891NxOeuqsxoyRKq2ox7hC7ue9L+lQGhz4srH1M+CdYSfz/jOX0nhZ+l40u6\n5JE3W7ekmeEZ7wn3V/07Lit2Jf02x8vfc1nbJ07T17vyarN4lWRzDAgDNDSVjSsO\n1I0zpq/l6ftatnhM9xPSLdzRel4pqPrAzMIXbDD7AoGBAIDhAA0Fqc90criYQa5B\n4Gwhqry+pwNLSeutLkY/hDxYlmUI5DxertjuE4INVKrwxz/PESq4+tY/C8jGGUBz\nN9bG49EFmFEL6/qlyw+i2xZK+ll5KTLwA123TvlyQuRH93BkHsE8sXdlOyVoD6rc\nqHSPJF5sjai62x9Nrhc6pFVDAoGAGlPvFl0B7QxsHl2m/3iRhRA9pePFsAPHUqaX\nk+xZxFbemNnx/uJq+oEKFv2Wa50VT485Vvoxygmp4venuqXWczHveKA3mh5KCKMb\ncK9F1fvDUm/i/i+AEB0/77J0baeSiJCM3SM9CKq5QispLY/vfIFx90hsByGEwk1f\ncjlxRHsCgYEA9s7GhiNY35mhyIPCBTXEJSry770RIR8ubkL2Qn5tjA0v4hin7eZt\nZFOlOX8T1/g+Ze6spU9rm/MxHSfMwDR+VXNr6Z86cwC99lwvsgy2IVSltz/0KrmP\ngj+/MEKDdrdWjOLzMSdxPlRoDqqPghscG+gW0rLDV7khULn59T1Sx9s=\n-----END RSA PRIVATE KEY-----\n}
    accessTokenExpiration: ${JWT_EXPIRATION:3600} # 1 hour
    refreshTokenExpiration: ${JWT_EXPIRATION:2419200} # 28 days
  apikey:
    root-key: ${ROOT_API_KEY:secret_changeme}

spring:
  application:
    name: einnsyn-backend
    environment: local
  config:
    import: optional:file:.env[.properties]
  main:
    allow-bean-definition-overriding: true
  mail:
    host: ${EMAIL_SMTP:localhost}
    port: ${EMAIL_PORT:587}
    username: ${EMAIL_USER:}
    password: ${EMAIL_PASS:}
    properties:
      mail:
        smtp:
          auth: ${EMAIL_SMTP_AUTH:false}
          protocol: ${EMAIL_SMTP_PROTOCOL:smtp}
  jpa:
    open-in-view: true
    properties:
      hibernate:
        ddl-auto: validate
        session:
          events:
            log: LOG_QUERIES_SLOWER_THAN_MS=1000
        jdbc:
          fetch_size: 100
          batch_size: 100
  datasource:
    url: ${SPRING_DATASOURCE_URL:jdbc:postgresql://localhost/arkiv}
    username: ${SPRING_DATASOURCE_USERNAME:einnsyn}
    password: ${SPRING_DATASOURCE_PASSWORD:admin}
  mvc:
    log-resolved-exception: false
    pathmatch:
      matching-strategy: ANT_PATH_MATCHER
    converters:
      preferred-json-mapper: gson
  flyway:
    enabled: true
    locations: classpath:db/migration
    placeholders:
      apikey-root-key: ${application.apikey.root-key}
    placeholder-replacement: true
    out-of-order: true
  # security:
  #   oauth2:
  #     client:
  #       registration:
  #         ansattporten:
  #           provider: ansattporten
  #           client-id: my-client-id
  #           client-secret: my-client-secret
  #           authorization-grant-type: authorization_code
  #           scope: openid,profile
  #       provider:
  #         ansattporten:
  #           issuer-uri: "https://ansattporten.no/.well-known/openid-configuration"
  threads:
    virtual.enabled: true

management:
  server:
    port: 8090
  endpoint:
    health:
      enabled: true
      show-details: always
    info:
      enabled: true
    metrics:
      enabled: true
    prometheus:
      enabled: true
  endpoints:
    web:
      base-path: /
      exposure:
        include: "*"
  prometheus:
    metrics:
      export:
        enabled: true

---
spring:
  config:
    activate:
      on-profile: test
  jpa:
    properties:
      hibernate:
        cache:
          use_second_level_cache: false
          use_query_cache: false
  datasource:
    driver-class-name: org.testcontainers.jdbc.ContainerDatabaseDriver
    url: jdbc:tc:postgresql:16.3:///arkiv
---
spring:
  config:
    activate:
      on-profile: container
server:
  shutdown: graceful
logging:
  config: classpath:logback-container.xml
